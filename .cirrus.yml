env:
# ENCRYPTED
  RCLONECONFIG_DRIVE: "ENCRYPTED[abe32a5aac4cbaf583ab18f9eb982be070aa001d3a137680ecd9ca4d63c4bc090a43362669d5d0fd6d9c3295a4a4a760]"
  TG_TOKEN: "ENCRYPTED[6701b20c8e32dc8aea0c1f953ac0939e2685e4679332b1197402f83b74df079b85249886be414b2aac76b87e3d132391]"
  TG_CHAT_ID: "ENCRYPTED[6fcc1b71fe788425f68981785cfb9411af25a844b0ca633d5f731cb0e4d7f9548122a1f0177b15ddf5d7a4797d8eec2f]"
  CREDENTIALS: "ENCRYPTED[cb7ed49344ea6fe84379576bc51c956746792a8bc0fbfb40b0fa3eb92c511083f81e086b3afe702f432d08181d55879f]"
  USER: "ENCRYPTED[80bb6aafa08abc43dcddfd567bacbba4c95c0689b9bb1ecf7a6b832e4c04185b97a7e32ea71e9b439a6dccfc7eeed496]"
  EMAIL: "ENCRYPTED[f09e3364ba2c58c60596d3bcaceae7e1ae482db1a0f9c862a1e348199ee171d0ceed19b44e7d047ba58d416f8d82e6a9]"
  KBUILD_BUILD_USER: "ENCRYPTED[6be41479968e84fddfa26ddabd300819404173f7470c918f3be91c73b3a1eec6427933736a203b04d40e2112cbe6bc4b]"
  KBUILD_BUILD_HOST: "ENCRYPTED[3e604a6a2894c9169ec864af74a5416321b1aec6eebe245ce6137a7d61c8daf8bc30b8fdfd25daf1e8a0aaf4ed0507f8]"
 
# FLAG
  WORKDIR: "/tmp"
  CIRRUS_CLONE_DEPTH: "1"
  
# TARGET
  APPS: "Settings"

task:
  name: "Setting Up, Syncing, Building and Uploading"
  only_if: $CIRRUS_REPO_OWNER == 'DeclanG9'
  timeout_in: 120m
  container:
    image: c3eru/gaspoll:22.04
    cpu: 8
    memory: 32G

  Memuat-ccache_background_script:
     - ./script/memuat_ccache.sh
     
  Repo-pribadi_script:
     - git config --global user.name "$USER"
     - git config --global user.email "$EMAIL"
     - echo "$CREDENTIALS" > ~/.git-credentials
     - git config --global credential.helper store --file=~/.git-credentials
     - export KBUILD_BUILD_USER=$KBUILD_BUILD_USER
     - export KBUILD_BUILD_HOST=$KBUILD_BUILD_USER
     - export BUILD_USERNAME=$KBUILD_BUILD_USER
     - export BUILD_HOSTNAME=$KBUILD_BUILD_USER


  Sinkronisasi_script:
     - ./script/sinkronisasi.sh
     
  Build-rom_script:
     - ./script/membangun.sh
     
  Ccache-info_script:
     - set -e
     - export CCACHE_DIR=$WORKDIR/ccache
     - ccache -s

  Upload-build_script:
     - ./script/mengunggah.sh
